webswingRequirejs.define(["jquery","webswing-util","webswing-polyfill","webswing-base","webswing-socket","webswing-files","webswing-dialog","webswing-login","webswing-canvas","webswing-identity","webswing-jslink","webswing-clipboard","webswing-playback","webswing-input","webswing-touch","webswing-inject","webswing-translate","webswing-ping"],function(t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){function x(e){e=e!=null?e:w;var n={},r=t("[data-webswing-instance]");r.each(function(r,i){var s=t(i).data("webswingInstance"),o=t(i).data("webswingActive");if(!o){var u;e[s]!=null&&e[s].options!=null&&(t(i).data("webswingOptions",e[s].options),e[s].options.customization!=null&&typeof e[s].options.customization=="function"&&(u=e[s].options.customization)),t(i).find("#loading").remove();var a=T(t(i),u);t(i).attr("data-webswing-active","true"),s!=null&&(n[s]=a)}});for(var i in n)e[i]!=null&&e[i].disconnect!=null&&(console.warn("Bootstrapping Webswing instance named '"+i+"'.Instance with this name has already been bootstrapped. Disconnecting old instance."),e[i].disconnect(),delete e[i]),e[i]=t.extend(n[i],e[i])}function T(e,t){var n=new m;n.module("webswing",new N(e)),n.module("dialog",new u),n.module("canvas",new f),n.module("base",new i),n.module("input",new d),n.module("touch",new v),n.module("socket",new s),n.module("files",new o),n.module("login",new a),n.module("identity",new l),n.module("jslink",new c),n.module("clipboard",new h),n.module("playback",new p),n.module("translate",new g),n.module("ping",new y);var r={start:"webswing.start",disconnect:"webswing.disconnect",configure:"webswing.configure",kill:"base.kill",setControl:"webswing.setControl",repaint:"base.repaint",uuid:"socket.uuid"};return n.module("external",{provides:r,injects:r}),t!=null&&t(n),n.injectAndVerify(),r}function N(e){function s(){return{rootElement:o(e),autoStart:!1,args:null,connectionUrl:location.origin+location.pathname,mirror:!1,recordingPlayback:!1,typedArraysSupported:E,binarySocket:!0,recording:!1,debugPort:null,javaCallTimeout:3e3,documentBase:document.location.origin+document.location.pathname,ieVersion:n.detectIE(),isMac:n.detectMac(),clientId:null,viewId:null,hasControl:!1,mirrorMode:!1,canPaint:!1,virtualKB:!1,traceLog:!1,touchMode:!1}}function o(e){return e.addClass("webswing-element")}function u(){if(!n.checkCookie()){i.showDialog(i.cookiesDisabledDialog);return}i.login(function(){i.startPing(),i.showDialog(i.initializingDialog),i.connect()})}function a(){i.disconnect(),i.disposeIdentity(),i.start()}function f(){i.disconnect(),i.start()}function l(){i.disposeFileDialog(),i.disposeBase(),i.disposeInput(),i.disposeTouch(),i.disposeCanvas(),i.disposeSocket(),i.disposeCopyBar(),i.disposePing()}function c(e,n){var r=i.cfg;e=e!=null?e:p(r.rootElement);if(e==null)return t.extend(!0,[],r);r.autoStart=e.autoStart!=null?JSON.parse(e.autoStart):r.autoStart,r.securityToken=e.securityToken!=null?e.securityToken:r.securityToken,r.realm=e.realm!=null?e.realm:r.realm,r.args=e.args!=null?e.args:r.args,r.binarySocket=e.binarySocket!=null?JSON.parse(e.binarySocket):r.binarySocket,r.recording=e.recording!=null?JSON.parse(e.recording):r.recording,r.clientId=e.clientId!=null?e.clientId:r.clientId,r.mirror=e.mirrorMode!=null?JSON.parse(e.mirrorMode):r.mirror,r.connectionUrl=e.connectionUrl!=null?e.connectionUrl:r.connectionUrl,r.debugPort=e.debugPort!=null?e.debugPort:r.debugPort,r.debugLog=e.debugLog!=null?JSON.parse(e.debugLog):r.debugLog,r.traceLog=e.traceLog!=null?JSON.parse(e.traceLog):r.traceLog,r.javaCallTimeout=e.javaCallTimeout!=null?parseInt(e.javaCallTimeout,10):r.javaCallTimeout,r.connectionUrl.substr(r.connectionUrl.length-1)!=="/"&&(r.connectionUrl=r.connectionUrl+"/"),e.recordingPlayback!=null&&(r.recordingPlayback=e.recordingPlayback,i.showPlaybackControls()),r.onReady=typeof e.onReady=="function"?e.onReady:r.onReady,n=n!=null?n:d(r.rootElement);if(n!=null){r.params=[];for(var s in n)typeof n[s]=="string"&&r.params.push({name:s,value:n[s]})}}function h(e){i.cfg.hasControl=e?!0:!1}function p(e){var t=e.data("webswingOptions");return t}function d(e){var n={},r=t(e).find("webswing-param");for(var i=0;i<r.length;i++){var s=r[i].getAttribute("name"),o=r[i].getAttribute("value");s!=null&&(n[s]=o)}return n}var r=this,i;r.injects=i={cfg:"webswing.config",start:"webswing.start",disconnect:"webswing.disconnect",login:"login.login",connect:"socket.connect",showDialog:"dialog.show",readyDialog:"dialog.content.readyDialog",initializingDialog:"dialog.content.initializingDialog",cookiesDisabledDialog:"dialog.content.cookiesDisabledDialog",disposeIdentity:"identity.dispose",disposeBase:"base.dispose",disposeCanvas:"canvas.dispose",disposeTouch:"touch.dispose",disposeInput:"input.dispose",disposeSocket:"socket.dispose",disposeFileDialog:"files.close",disposeCopyBar:"clipboard.dispose",disposePing:"ping.dispose",startPing:"ping.start",showPlaybackControls:"playback.showControls",externalApi:"external"},r.provides={config:s(),start:u,newSession:a,reTrySession:f,disconnect:l,setControl:h,configure:c},r.ready=function(){c(),typeof i.cfg.onReady=="function"&&i.login(function(){i.cfg.onReady(i.externalApi)}),i.cfg.autoStart?i.start():i.showDialog(i.readyDialog)}}var b=t("[data-webswing-global-var]"),w={},E=r();if(b!=null&&b.length!==0){var S=b.data("webswingGlobalVar");w=window[S]={scan:x,bootstrap:T,utils:n,$:t},x(window)}else x(window)});