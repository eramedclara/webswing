webswingRequirejs.define(["jquery","text!templates/dialog.html","text!templates/network.html"],function(t,n,r){return function(){function g(){return{emptyMessage:y("dialog.emptyMessage",!0),logingOut:y("dialog.logingOut"),readyDialog:y("dialog.readyDialog"),initializingDialog:y("dialog.initializingDialog",!0),startingDialog:y("dialog.startingDialog",!0),connectingDialog:y("dialog.connectingDialog",!0),applicationBusyDialog:y("dialog.applicationBusyDialog",!0),unauthorizedAccess:w("dialog.unauthorizedAccess"),applicationAlreadyRunning:w("dialog.applicationAlreadyRunning"),sessionStolenNotification:w("dialog.sessionStolenNotification"),disconnectedDialog:w("dialog.disconnectedDialog"),connectionErrorDialog:w("dialog.connectionErrorDialog"),tooManyClientsNotification:w("dialog.tooManyClientsNotification"),stoppedDialog:b("dialog.stoppedDialog"),timedoutDialog:b("dialog.timedoutDialog"),cookiesDisabledDialog:y("dialog.cookiesDisabledDialog"),continueOldSessionDialog:{header:'<span class="ws-message--neutral">${dialog.continueH} <span data-id="dialogHide" class="ws-icon-cancel-circled ws-right"></span></span>',content:'<p data-id="continueMsg">${dialog.continueC1}<a href="javascript:void(0)" data-id="restartLink">${dialog.continueC2}</a></p>',events:{restartLink_click:function(){s.kill(),s.newSession()},dialogHide_click:C,continueMsg_mouseenter:function(){h.focused=!0},continueMsg_mouseleave:function(){h.focused=!1}}},longPollingWarningDialog:{header:'<span class="ws-message--warning"><span class="ws-icon-warn"></span> ${dialog.longPollingH}</span>',content:"<p>${dialog.longPollingC} </p>",buttons:[{label:'<span class="ws-icon-cancel-circled"></span>  ${dialog.longPollingB}',action:function(){C()}}]},inactivityTimeoutWarningDialog:{header:'<span class="ws-message--warning"><span class="ws-icon-warn"></span> ${dialog.inactivityTimeoutH}</span>',content:"<p>${dialog.inactivityTimeoutC}  </p>",buttons:[{label:'<span class="ws-icon-cancel-circled"></span>  ${dialog.inactivityTimeoutB}',action:function(){C()}}]},networkOfflineWarningDialog:{content:'<span class="ws-message--error"><span class="ws-icon-warn"></span>${dialog.networkMonitor.offline}</span>',severity:2},networkSlowWarningDialog:{content:'<span class="ws-message--warning"><span class="ws-icon-warn"></span>${dialog.networkMonitor.warn}</span>',severity:1}}}function y(e,t){var n="<p>${"+e+"}</p>";return t&&(n='<div class="ws-spinner"><div class="ws-spinner-dot-1"></div> <div class="ws-spinner-dot-2"></div></div>'+n),{content:n}}function b(e){return{content:"<p>${"+e+"}</p>",buttons:[{label:'<span class="ws-icon-certificate"></class> ${dialog.finalB1}',action:function(){s.newSession()}},{label:'<span class="ws-icon-logout"></class> ${dialog.finalB2}',action:function(){s.logout()}}]}}function w(e){return{content:"<p>${"+e+"}</p>",buttons:[{label:'<span class="ws-icon-arrows-cw"></class> ${dialog.retryB1}',action:function(){s.reTrySession()}},{label:'<span class="ws-icon-logout"></class> ${dialog.retryB2}',action:function(){s.logout()}}]}}function E(){s.cfg.rootElement.append(n),l=s.cfg.rootElement.find('div[data-id="commonDialogBackDrop"]'),u=s.cfg.rootElement.find('div[data-id="commonDialog"]'),a=u.find('div[data-id="content"]'),f=u.find('div[data-id="header"]'),p=s.cfg.rootElement.find('div[data-id="commonBar"]'),d=p.find('div[data-id="content"]'),v=p.find('div[data-id="header"]'),p.hide(),t(document).ajaxStart(function(){c=setTimeout(function(){u.is(":visible")&&t("#ajaxProgress").slideDown("fast")},200)}).ajaxComplete(function(){clearTimeout(c),t("#ajaxProgress").hide()})}function S(e){if(e==null)return;return u==null&&E(),o=e,T(e,u,f,a),l.show(),u.slideDown("fast"),a}function x(e){if(e==null)return;return p==null&&E(),h=e,T(e,p,v,d),p.slideDown("fast"),d}function T(e,n,r,i){e.header!=null?(r.html(s.translate(e.header)),n.is(":visible")?r.fadeIn(200):r.show()):(r.hide(),r.html("")),i.html(s.translate(e.content));for(var o in e.events){var u=n.find('*[data-id="'+o.substring(0,o.lastIndexOf("_"))+'"]');u.bind(o.substring(o.lastIndexOf("_")+1),e.events[o])}for(var a in e.buttons){var f=e.buttons[a],l=t('<button class="ws-btn">'+s.translate(f.label)+"</button><span> </span>");l.on("click",f.action),i.append(l)}n.is(":visible")&&i.fadeIn("fast")}function N(){o=null,a.html(""),u.fadeOut("fast"),l.fadeOut("fast")}function C(){h=null,d.html(""),p.fadeOut("fast")}function k(){return o}function L(){return h}function A(e){m==null&&(s.cfg.rootElement.append(s.translate(r)),m=s.cfg.rootElement.find('div[data-id="networkBar"]'),m.find('a[data-id="hide"]').on("click",function(t){s.mutePingWarning(e.severity),O()})),m.find('span[data-id="message"]').html(s.translate(e.content)),m.show("fast")}function O(){m!=null&&(m.hide("fast"),m.remove(),m=null)}var i=this,s;i.injects=s={cfg:"webswing.config",continueSession:"base.continueSession",kill:"base.kill",newSession:"webswing.newSession",reTrySession:"webswing.reTrySession",logout:"login.logout",translate:"translate.translate",mutePingWarning:"ping.mutePingWarning"},i.provides={show:S,hide:N,current:k,content:g(),currentBar:L,showBar:x,hideBar:C,showNetworkBar:A,hideNetworkBar:O};var o,u,a,f,l,c,h,p,d,v,m}});